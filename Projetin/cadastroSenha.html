<!DOCTYPE html>
<html>
    <head>
        <meta http-equiv="content-type" content="text/html; charset=utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <title>LoginDisney+ </title>
        <link rel="stylesheet" href="css/cadastro.css"/>
    </head>
    <body>
        <br>
        <br>
        <div class="imagemm">
            <div class="Imagem">
                <img src="IMG/disney-plus-logo-1.png">
            </div>
        </div>
        <div class="inicio1">
            <p style="text-transform: uppercase;">Passo 2 de 2</p>
            <h3>Crie uma senha</h3>
            <input id="senha" type="password"  maxlength="10" minlength="4" pattern="(?=.*\d)(?=.*[a-z])(?=.*[A-Z]).{4,}"required placeholder=" Senha">
                <br>
                <div id="certo" class="normal">Use no mínimo quatro caracteres e no máximo dez, com pelo menos um número, uma letra maiúscula e uma letra minúscula.</div>
                <div id="erro" class="erro">A senha deve ter pelo menos quatro caracteres e no máximo dez, incluindo pelo menos um número, uma letra maiúscula e uma letra minúscula.</div>
                <br>
            <input id="botão" type="button" value = "continuar" >
        </div>
            <script type="text/javascript"charset= "utf-8">
                var input = document.querySelector('input'),
                erro = document.querySelector('.erro'),
                Token = location.search.slice(1),
                senha =document.querySelector('.senha'),
                normal = document.querySelector('.normal');

                document.getElementById('botão').addEventListener('click', function(){
                    if (input.validity.valid == true){
                        let xhr = new XMLHttpRequest();
                        xhr.open('POST', 'https://reqres.in/api/register',true);
                        xhr.setRequestHeader("Content-Type", "application/json; charset=utf-8");
                        xhr.onreadystatechange = function() {
                            if (xhr.readyState == 4) {
                                if (xhr.status == 200){
                                    window.localStorage.setItem(JSON.parse(xhr.response).id, JSON.parse(xhr.response).token);
                                    window.location.href = ('//C:/Users/Marco/OneDrive/%C3%81rea%20de%20Trabalho/C%23/Projetin/Principal.html');
                                }
                                if(xhr.status == 400){
                                    document.getElementById("certo").style.display = 'none';
                                    document.getElementById("erro").style.display = 'block';
                                    document.getElementById('senha').focus();
                                }
                            }
                        }
                            xhr.send(JSON.stringify({
                                email: Token,
                                password: input.value
                            }));
                    }else{
                        document.getElementById("certo").style.display = 'none';
                        document.getElementById("erro").style.display = 'block';
                        document.getElementById('senha').focus();
                    }
                });
            </script>
            </script>
    </body>
</html>